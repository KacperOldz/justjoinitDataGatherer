import matplotlib.pyplot as plt
from datetime import datetime
import os
import json

data = []

with open('config.json', 'r') as file:
    json_data = file.read()
    config = json.loads(json_data)

colors = [lang["color"] for lang in config["languages"]]
languages = [lang["label"] for lang in config["languages"]]

def drawGraph():
    for j in range(0, len(colors)):
        x = [datetime.strptime(line[0], "%Y-%m-%d") for line in data]
        y = [int(line[j+1]) for line in data]
        plt.plot(x, y, color=colors[j], label=languages[j])
    plt.xlabel('Date')
    plt.ylabel('Amount')
    plt.xticks(rotation=45)
    plt.legend()
    plt.show()
def readData(fileName):
    with open(fileName, 'r') as file:
        lines = file.readlines()
        for line in lines:
            elements = line.split()
            data.append([num for num in elements[0:len(elements)]])

def main():
    global data
    contin = True
    while (contin):
        data = []
        txt_files = [file for file in os.listdir('./') if file.endswith('.txt')]
        for i in range(0, len(txt_files)):
            print(str(i) + ". " + txt_files[i])
        index = input(":")
        readData(txt_files[int(index)])
        drawGraph()

if __name__ == '__main__':
    main()
